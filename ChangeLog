
2003-03-27  Hynek Hanke <hanke@volny.cz>
    * src/server/server.c: Compare against \r\n.\r\n only if there are enough bytes.


2003-03-27  Tomas Cerha  <cerha@brailcom.org>

	* INSTALL (Module): `robod' -> `speechd'.

	* INSTALL.in (Module): `robod' -> `speechd'.
	

2003-03-25  Hynek Hanke <hanke@volny.cz>
	* src/server/speechd.c: Logging messages switched to their levels of verbosity.
	* src/server/speechd.c (speechd_modules_terminate()): Call module_speak for each module being closed.
	* src/server/speechd.c (MSG): Now a function instead of macro.
	* src/server/speechd.h (MSG): Declaration.
	* src/server/speechd.h (FATAL) (DIE): Macros moved from src/intl/def.h 
	* src/server/server.c (speak()): Ignore all signals in this thread.
	* src/server/server.c: Logging messages switched to their levels of verbosity.
	* src/modules/flite.c (flite_close): Terminate the flite_speak() thread if speaking.
	* src/server/dc_decl.c (LogFile()): New DotConf callback function.	
	* src/intl/def.h: - MSG, FATAL, DIE
	* speechd.conf: + LogFile settings.

2003-03-24  Hynek Hanke <hanke@volny.cz>
	* src/server/server.c: Changes in SSIP.
	* src/server/set.c: Changes in SSIP.
	* src/server/history.c: Changes in SSIP.
	* src/server/parse.c: Changes in SSIP.
	* src/server/msg.h: Numerical codes of return values added.
	* src/clients/libspeechd.c: Changes in SSIP.
	* src/clients/spd_center.c: Priority 2 in menu -> priority 3.
	* src/clients/speechd.c: Some messages switched to another levels of verbosity.

2003-03-23  Hynek Hanke <hanke@volny.cz>
	* src/modules/flite.c (DEBUG_FLITE): A new switch.
	* src/modules/flite.c (flite_stop()): Send SIGKILL instead of SIGINT.
	* src/server/server.c: All stops are now called in the separate speak() thread (faster).
	* src/server/server.c (fd_settings): now hash_table instead of a list
	* src/server/server.c (speak()): Uses mutexes to be thread safe.
	* src/server/set.c (fd_settings): now hash_table instead of a list
	* src/server/history.c (fd_settings): now hash_table instead of a list
	* src/server/alloc.c: Functions for allocating and freeing data structures;
	* src/tests/long_message.c: New test trying to say two long texts.
	* src/server/speechd.c: select() now doesn't return unless there is some communication.
	* src/server/speechd.c: Speech Deamon now doesn't interrupt client's messages on @quit.
	* src/server/speechd.c: fd_settings now hash_table instead of a list
	* src/server/speechd.c (terminate_client): New function for unloading clients.
	* src/server/speechd.c (terminate_module): New function for unloading modules.
	* src/server/speechd.c (stop_c()): Uses mutexes to be thread safe.
	* src/server/module.c (load_output_module()): Write gmodule* into module_info.
	* src/server/Makefile.am: Added new sources.
	* src/clients/spd_center.c: Now uses priority 3 instead of sending @stops.
	* src/clients/libspeechd.c: (LIBSPEECHD_DEBUG): New define macro for debugging.
	* src/clients/libspeechd.h: (LIBSPEECHD_DEBUG): New define macro for debugging.
	* intl/def.h: (SPEECHD_DEBUG): New preprocesor variable for debugging.
	* intl/module.h (OutputModule): New entry gmodule*
	* Polished.


2003-03-13  Hynek Hanke <hanke@volny.cz>
    * src/modules/flite.c: Now uses threads and processes to get better performance.
    * src/modules/Makefile.am: Links also flite shared libraries.
    * src/clients/libspeechd.c: Cosmetical changes.
    * src/tests: New directory.
    * src/tests/Makefile.am: Makefile for new directory.
    * src/tests/multiple_messages.c: New file, a speed test.
    * src/server/server.c (speaking_module): Now directly a pointer to the module instead of its name.
    * src/server/server.c (speak): speak() is now a separate thread.
    * src/server/speechd.c (main): speak_thread initialization.
    * src/server/speechd.h (speak_thread): New thread for speak().
	* src/Makefile.am: Added new directory tests.
	* configure.in: Added tests for pthread and flite shared libraries.
	* INSTALL: Note about the requierement to have compiled flite with shared libraries.
	* speechd.conf: Default values of speed and pitch of voice now 0, not 100.

2003-03-16  Tomas Cerha  <cerha@brailcom.org>

	* README: Robod -> Speech Daemon.

	* INSTALL: pkg-config and libtool added to requirements.  
	Robod -> Speech Daemon.  Cosmetical changes.

2003-03-13  Hynek Hanke	 <hanke@volny.cz>
	* src/modules/flite.c: Bug with swapped flite_is_speaking() and flite_close() fixed.
	* src/intl/module.h: Bug with swapped flite_is_speaking() and flite_close() fixed.

2003-03-12  Hynek Hanke  <hanke@volny.cz>

	* src/clients/libspeechd.c (spd_say()): Bug with @data off corrected.
	* src/clients/libspeechd.c (spd_voice_rate()): Renamed from spd_voice_speed().
	* src/clients/libspeechd.c (spd_voice_punctuation()): Now accepts 3 values (0=no,1=full,2=some).
	* src/server/server.c (parse()): o_buf now doesn't have fixed size.
	* src/clients/say.c (main()): Things that shouldn't be there removed.
	* src/server/parse.c (parse_set): New SSIP commands for settings.
	* src/server/set.c: New SSIP commands for settings.
	* src/modules/flite.c (flite_pause()): Function removed, unnecessary.
	* src/modules/flite.c (flite_resume()): Function removed, unnecessary.
	* src/modules/flite.c (flite_close()): New function.
	* src/modules/festival.c (festival_pause()): Function removed, unnecessary.
	* src/modules/festival.c (festival_resume()): Function removed, unnecessary.
	* src/modules/module.h (OutputModule): Reworked.
	* src/server/msg.h: New SSIP messages for the settings commands.
	* src/server/set.h: Headers for new settings functions.

2003-03-12  Milan Zamazal  <pdm@brailcom.org>

    * src/clients/libspeechd.c: `speed' -> `rate'.
    * src/clients/libspeechd.h: Likewise.
    * src/clients/spd_center.c: Likewise.


2003-03-09  Hynek Hanke  <hanke@volny.cz>

	* src/clients/libspeechd.c (spd_icon()): New function.
	* src/clients/libspeechd.c (spd_say_letter()): New function.
	* src/clients/libspeechd.c (spd_say_digit()): New function.
	* src/clients/libspeechd.c (spd_say_sgn()): New function.
	* src/clients/libspeechd.c (spd_say_key()): New function.
	* src/clients/libspeechd.c (spd_voice_speed()): New function.
	* src/clients/libspeechd.c (spd_voice_pitch()): New function.
	* src/clients/libspeechd.c (spd_voice_punctuation()): New function.
	* src/clients/libspeechd.c (spd_voice_cap_let_recognition()): New function.
	* src/clients/libspeechd.h: Declarations of new functions.
	* src/server/server.c (queue_message()): Splitted from parse().
	* src/server/server.c (parse()): Added handling for new SSIP command @snd_icon.
	* src/parse.c (parse_snd_icon()): New function.
	* src/server/snd_icons_en.conf: New file. Rules for sound icons in English.
	* src/server/dc_decl.c (cb_AddSndIcons): New DotConf callback.
	* src/server/speechd.h (snd_icon_langs): New hash table for maintaining information about defined sound icons.


2003-03-05  Milan Zamazal  <pdm@brailcom.org>

	* INSTALL: libdotconf added to the required software.  Current way
	of the build process mentioned.

2003-03-04  Milan Zamazal  <pdm@brailcom.org>

	* src/clients/say.c (main): Dummy `cl_active' argument added to
	the `spd_get_client_list' call.

01.02.2003	Hynek Hanke <hanke@volny.cz>
	* Added copyright notices to each file, better comments.
	* doc/: Switched to Texinfo.

11.1.2003	Hynek Hanke <hanke@volny.cz>

	* /src/client/spd_center.c (spdc_complete): String completion from given template.
	* /src/client/spd_center.h (quit()): endwin() added to fix the weird behavior after quitting.
	* /src/client/spd_center.h (TComplete): Data type for string completion.
	* /src/server/server.c: Handling of pause messages moved to stop_c(), because the problem of queues (we can't browse through them) is solved by using list and treating them as semi-queues instead.
	* /src/client/libspeechd.c (spd_history_say_msg()) (spd_history_select_client()) (spd_get_message_list_fd()): New functions.

4.1.2003	Hynek Hanke	<hanke@volny.cz>

	* /src/server/speechd.c (main): Added handling for SIGINT and the function quit() 
	* /src/server/speechd.c (history_list_alloc_message): Bug with not copying the actual data of settings.language,output_module and client_name, but only pointers to them fixed.
	* /src/server/server.c (serve): Bug with the missing FD_CLR() fixed.
	* /src/server/server.c (awaiting_data): the size of awaiting_data array is now handled in speechd.c
	* /src/server/server.c (stop_c): the section handling @stop completely reworked.
	* /src/client/spd_center.c: Implemented command input/menu logic.
	* /src/client/spd_center.c (selected): New data structure for maintaining record of what has the user selected (which client has he chosen, which subclient, which mode of sorting, etc.)
	* /src/clients/spd_center.c (spdc_initialize()): Fills _selected_ with default values.
	* /src/clients/spd_center.c: Strings prepared for gettext().
	* /src/clients/spd_center.h: New header file for spd_center.c
	* /src/clients/spd_center.c (run_cmdl()): Pause and resume functions implemented (pause(), pause(fd), pause_cur_client(), resume(), resume(fd), resume_cur_client()).
	* /src/clients/spd_center.c (run_cmdl()): Stop functions implemented (stop(), stop(fd), stop_cur_client()).
	* /src/server/speechd.c (stop_c): New parameter _target_ for stopping other clients (needed for spd_center).
	* /src/clients/libspeechd.c (spd_stop_fd(fd): Stop messages from other client fd.
	* /src/clients/libspeechd.c (spd_pause_fd(fd): Pause messages from other client fd.
	* /src/clients/libspeechd.c (spd_resume_fd(fd): Resume messages from other client fd.
	* /src/server/parse.c: Added support for @stop, @pause, @resume with parameter.
	* /src/server/set.c: Added support for @stop, @pause, @resume with parameter.
	* /intl/def.h (FATAL()): Now prints the exact line and fil when the error ocured.
	* /intl/fdset.h (TFDSetElement): Added new record int uid for unique id of the client.


16.12.2002	Hynek Hanke	<hanke@volny.cz>

	* /src/server/speechd.c (main): Test for msgs_to_say, select has timeout of 10us, but added a sleep() after each cycle (highly reduces CPU usage).
	* /src/server/speechd.h (msgs_to_say): New global variable: number of messages to be said (for lower CPU usage)
	* /src/client/spd_center.c: New file. Speech Deamon Center -- combined history and configuration client.
	* /src/server/Makefile.am: Sysconfdir passed to gcc as -D from @sysconfdir@ (needed for loading speechd.conf).
	* /src/server/Makefile.am: Libdir passed to gcc as -D from @libdir@.
	* /src/server/history.c (history_say_id()): msgs_to_say incremented.
	* /src/server/history.c (history_get_message_list()): Find proper client, added third parametr client_id.
	* /src/server/history.c: Multiline commands now terminate with '\'.
	* /src/server/history.c (send_data()): char *reply returned is now dynamic.
	* /src/server/parse.c (history_get_message_list()): Added third parametr client_id for @history get message_list.
	* /src/server/set.c (set_client_name()): Now affects also history client settings.
	* /src/client/libspeechd.c: Multiline return values. History get clients/messages function.
8.12.2002	Hynek Hanke	<hanke@volny.cz>

	* Renamed back to Speech Deamon

2.11.2002	Hynek Hanke	<hanke@volny.cz>

	* gdsl --> glib2 transaction
	* polished
	* Autoconf and all it's standard files and various Makefile.am
	* /src/server/msg.h: New file defining the messages transmitted between client and server.
	* /src/server/parse.c: Functions related to parsing the input from the client moved here.
	* /src/server/set.c: Functions related to setting parameters of the client/server session moved here.
	* /src/server/set.c (set_client_name()): New function: @set client_name implemented.
	* /src/server/server.c: Polished, some functions moved to set.c and parse.c.
	* /src/server/server.c (parse()): The ugly 3 static arrays are now dynamic ones defined in robod.h and initialized in robod.c
	* /src/server/history.c (history_cursor_set_last()): Bug fixed: move to the last entry _minus_one_ (this is a property of glib)
	* /src/server/dc_decl.h: Added configuration for DefaultModule, DefaultSpeed, DefaultPitch, DefaultLanguage, DefaultPriority, DefaultPunctuationMode, DefaultClientName, DefaultVoiceType, DefaultSpelling, DefaultCapLetRecognition.
	* /src/server/dc_decl.h: New file with definitions of DotConf callbacks and other things related to DotConf.
	* /src/server/Makefile.am: Added set.c, msg.h, parse.c.
	* configure.in: Configuration for autoconf.
	* /src/client/robodlib.c (rbd_sayf()): New function: the same as say, but formated in the printf() style.
	* /src/client/robodlib.c (rbd_stop()): New function.
	* /src/client/robodlib.c (rbd_pause()): New function.
	* /src/client/robodlib.c (rbd_resume()): New function.
	* /src/client/robodlib.c (rbd_init()): The part where connection name is set now working.

07.07.2002	Hynek Hanke <hanke@volny.cz>
	* /src/server/server.c (history_()): New functions called.
	* /src/server/server.c: Cosmetic changes.
	* /src/server/server.c: History functions moved to history.c.
	* /src/server/server.c: Messages are now inserted on tail of lists and got from it's head.
	* /src/server/history.h: New header file for history commands.
	* /src/server/history.c: New file for history commands.
	* /src/server/history.c (history_get_message_list()): New function.
	* /src/server/history.c (history_cursor_set_last()): New function.
	* /src/server/history.c (history_cursor_set_first()): New function.
	* /src/server/history.c (history_cursor_set_pos()): New function.
	* /src/server/history.c (history_cursor_next()): New function.
	* /src/server/history.c (history_cursor_prev()): New function.
	* /src/server/history.c (history_cursor_next()): New function.
	* /src/server/history.c (history_cursor_get()): New function.
	* /src/server/history.c (history_say_id()): New function.
	* /src/server/history.c (client_compare_id()): Moved from server.c; renamed.
	* /src/server/history.c (histset_compare_fd()): Moved from server.c; renamed.
	* /src/server/history.c (message_compare_id()): Moved from server.c; renamed.
        * /src/server/speechd.c: History clients are now inserted on tail of list. (more logical)
        * /src/server/speechd.c (default_fd_set): Bug with client_name fixed.
        * /src/server/speechd.h (THistSetElement): New type of structure for settings for each active client.
        * /src/server/speechd.h: (ESort) New enum type for sorting modes.
        

07.02.2002	Hynek Hanke <hanke@volny.cz>
	* /src/server/server.c (stop_speaking_active_module): New function divided from stop_c().
	* /src/server/server.c (history_get_client_list): New function implementing @history get client_list
	* /src/server/server.c (message_nto_speak): Changed name from message_to_speak (more logical). Added parameter void* value so that it's useful also as compare function for searching through queues and lists.
	* /src/server/server.c (MessagePausedList): Added list for messages that we get from output queues but it's client is paused. We browse through this list every cycle to see if some client have sent @resume.
	* /src/server/server.c (o_buf[fd][0] = 0;): Bug fixed.
	* /src/server/speechd.h (TFDSetElement): Moved to /include/fdset.h
	* /src/server/speechd.h (EVoiceType): Moved to /include/fdset.h
	* /src/server/speechd.h (client_name): Uncomented, now used.
	* /src/server/speechd.c : Now working with client_name.
	* /src/modules/flite.c (TFDSetElement): Moved to /include/fdset.h
	* /src/modules/flite.c (EVoiceType): Moved to /include/fdset.h
	* /include/fdset.h : New include file used in both modules and server.
